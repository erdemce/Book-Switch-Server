(this["webpackJsonpbookSwitch-client"]=this["webpackJsonpbookSwitch-client"]||[]).push([[0],{72:function(e,t,a){},73:function(e,t,a){},99:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),r=a(30),o=a.n(r),s=(a(71),a(72),a(73),a(15)),i=a(47),l=a(9),d=a(10),j=a(12),h=a(11),b=a(13),u=a(16),m=a(106),O=a(105),x=a(1),p=function(e){Object(j.a)(a,e);var t=Object(h.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(d.a)(a,[{key:"render",value:function(){return Object(x.jsx)("div",{children:Object(x.jsxs)(m.a,{className:"hor-ver-2 justify-content-between body-width",bg:"light",children:[Object(x.jsx)(m.a.Brand,{className:"justify-content-center logo",children:Object(x.jsx)(u.b,{to:"/",children:Object(x.jsxs)("h1",{children:["Book",Object(x.jsx)("span",{children:"Switch"})]})})}),Object(x.jsxs)(O.a,{className:"hor-ver-2 justify-content-end justify-content-around",activeKey:"/",children:[Object(x.jsx)(O.a.Item,{children:Object(x.jsxs)(u.b,{to:"/",children:[Object(x.jsx)("img",{src:"/assets/home.png",alt:"home-icon"}),Object(x.jsx)("br",{}),"Home"]})}),this.props.user&&Object(x.jsx)(O.a.Item,{children:Object(x.jsxs)(u.b,{to:"/messages",children:[Object(x.jsx)("img",{src:"/assets/002-speech-bubble.png",alt:"messages-icon"}),Object(x.jsx)("br",{}),"Messages"]})}),this.props.user&&Object(x.jsx)(O.a.Item,{children:Object(x.jsxs)(u.b,{to:"/profile",children:[Object(x.jsx)("img",{src:"/assets/005-like.png",alt:"profile-icon"}),Object(x.jsx)("br",{}),"Profile"]})}),this.props.user&&Object(x.jsx)(O.a.Item,{children:Object(x.jsxs)(u.b,{onClick:this.props.handleLogout,children:[Object(x.jsx)("img",{src:"/assets/016-shortcut-script-app.png",alt:"logout-icon"}),Object(x.jsx)("br",{}),"Log Out"]})}),!this.props.user&&Object(x.jsx)(O.a.Item,{children:Object(x.jsx)(u.b,{to:"/signup",children:"Signup"})}),!this.props.user&&Object(x.jsx)(O.a.Item,{children:Object(x.jsx)(u.b,{to:"/login",children:"Login"})})]})]})})}}]),a}(n.Component),g=a(8),f=a(7),v=a.n(f),y=a(32),w=a(65);var k=function(e){var t=Object(n.useState)([]),a=Object(g.a)(t,2),c=a[0],r=a[1],o=Object(n.useState)(""),s=Object(g.a)(o,2),i=s[0],l=s[1],d=Object(n.useState)(""),j=Object(g.a)(d,2),h=j[0],b=j[1],u=Object(n.useState)(""),m=Object(g.a)(u,2),O=m[0],p=m[1],f=Object(n.useState)(""),k=Object(g.a)(f,2),S=k[0],C=k[1],N=Object(n.useState)(""),I=Object(g.a)(N,2),E=I[0],L=I[1],B=Object(n.useState)(""),F=Object(g.a)(B,2),_=F[0],U=F[1];return Object(n.useEffect)((function(){var e=!0;return v.a.get("/api/location").then((function(t){e&&r(t.data)})).catch((function(e){console.log(e)})),function(){return e=!1}}),[]),Object(x.jsxs)(y.a,{className:"body-width",onSubmit:e.handleSubmit,children:[Object(x.jsxs)(y.a.Group,{children:[Object(x.jsx)(y.a.Label,{children:"Username"}),Object(x.jsx)(y.a.Control,{required:!0,name:"username",type:"text",placeholder:"Enter username",onChange:function(e){return b(e.target.value)},value:h})]}),Object(x.jsxs)(y.a.Group,{children:[Object(x.jsx)(y.a.Label,{children:"Name"}),Object(x.jsx)(y.a.Control,{name:"name",type:"text",placeholder:"Enter name",onChange:function(e){return l(e.target.value)},value:i})]}),Object(x.jsxs)(y.a.Group,{children:[Object(x.jsx)(y.a.Label,{children:"Last Name"}),Object(x.jsx)(y.a.Control,{name:"lastName",type:"text",placeholder:"Enter last name",onChange:function(e){return p(e.target.value)},value:O})]}),Object(x.jsxs)(y.a.Group,{controlId:"formBasicEmail",children:[Object(x.jsx)(y.a.Label,{children:"Email address"}),Object(x.jsx)(y.a.Control,{required:!0,name:"email",type:"email",placeholder:"Enter email",onChange:function(e){return L(e.target.value)},value:E}),Object(x.jsx)(y.a.Text,{className:"text-muted",children:"We'll never share your email with anyone else."})]}),Object(x.jsxs)(y.a.Group,{controlId:"formBasicPassword",children:[Object(x.jsx)(y.a.Label,{children:"Password"}),Object(x.jsx)(y.a.Control,{required:!0,name:"password",type:"password",placeholder:"Password",onChange:function(e){return U(e.target.value)},value:_})]}),Object(x.jsxs)(y.a.Group,{children:[Object(x.jsx)(y.a.Label,{children:"City"}),Object(x.jsx)(y.a.Control,{as:"select",placeholder:"Select your city",name:"location",onChange:function(e){return C(e.target.value)},value:S,children:c.map((function(e,t){return Object(x.jsx)("option",{value:e._id,children:e.city},t)}))})]}),Object(x.jsx)(w.a,{variant:"primary",size:"lg",block:!0,type:"submit",children:"Submit"})]})},S=a(101),C=a(107),N=function(e){Object(j.a)(a,e);var t=Object(h.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(d.a)(a,[{key:"render",value:function(){var e=this.props.book,t="/book/"+e._id;return Object(x.jsx)(u.b,{to:t,children:Object(x.jsxs)(C.a,{children:[Object(x.jsx)(C.a.Img,{style:{width:"120px",margin:"0 auto"},variant:"top",src:e.photo}),Object(x.jsxs)(C.a.Body,{children:[Object(x.jsx)(C.a.Title,{children:e.title}),Object(x.jsx)(C.a.Title,{children:e.author}),Object(x.jsx)(C.a.Text,{children:e.description})]}),Object(x.jsx)(C.a.Footer,{children:Object(x.jsx)("small",{classNameName:"text-muted",children:e.owner.city})})]})},e._id)}}]),a}(n.Component),I=function(e){Object(j.a)(a,e);var t=Object(h.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(d.a)(a,[{key:"render",value:function(){var e=this.props.forSearch;return Object(x.jsx)("section",{className:"searchbar body-width",children:Object(x.jsxs)("form",{className:"d-flex",action:"/home",method:"GET",children:[Object(x.jsx)("img",{width:"30px",src:"/assets/006-search.png",alt:"searchicon"}),Object(x.jsx)("input",{name:"searchedToy",className:"search-input form-control me-2",type:"search",placeholder:"Search by Author or Title","aria-label":"Search",onChange:e})]})})}}]),a}(n.Component),E=function(e){Object(j.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,c=new Array(n),r=0;r<n;r++)c[r]=arguments[r];return(e=t.call.apply(t,[this].concat(c))).state={books:[],filtered:[],mode:"all",searchText:""},e.handleSwitchMode=function(t){e.setState({mode:t},e.updateFilter)},e.handleSearch=function(t){var a=t.target.value.toLowerCase();e.setState({searchText:a},e.updateFilter)},e.updateFilter=function(){var t=e.state,a=t.searchText,n=t.mode,c=t.books.filter((function(e){return(e.title.toLowerCase().includes(a)||e.author.toLowerCase().includes(a))&&("all"===n||e.switchMode===n)}));e.setState({filtered:c})},e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){var e=this;v.a.get("/api/book").then((function(t){e.setState({books:t.data,filtered:t.data})})).catch((function(){console.log("Fetching failed")}))}},{key:"render",value:function(){var e=this,t=this.state,a=t.books,n=t.filtered;return 0===a.length?Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(S.a,{animation:"border",variant:"primary"}),Object(x.jsx)(S.a,{animation:"border",variant:"secondary"}),Object(x.jsx)(S.a,{animation:"border",variant:"success"}),Object(x.jsx)(S.a,{animation:"grow",variant:"primary"}),Object(x.jsx)(S.a,{animation:"grow",variant:"secondary"}),Object(x.jsx)(S.a,{animation:"grow",variant:"success"})]}):Object(x.jsxs)(c.a.Fragment,{children:[Object(x.jsxs)("section",{className:"categories",children:[Object(x.jsx)(w.a,{onClick:function(){return e.handleSwitchMode("all")},className:"btn btn-primary",children:"All"}),Object(x.jsx)(w.a,{onClick:function(){return e.handleSwitchMode("switch")},className:"btn btn-primary",children:"Switch"}),Object(x.jsx)(w.a,{onClick:function(){return e.handleSwitchMode("gift")},className:"btn btn-primary",children:"Gift"}),Object(x.jsx)(w.a,{onClick:function(){return e.handleSwitchMode("temporary-switch")},className:"btn btn-primary",children:"Temporary Switch"}),Object(x.jsx)(w.a,{className:"btn btn-primary",children:Object(x.jsx)(u.b,{to:"/book/random",children:"Random Book"})})]}),Object(x.jsx)(I,{forSearch:this.handleSearch}),Object(x.jsx)("div",{className:"row row-cols-1 row-cols-md-3 g-4",children:n.map((function(e){return Object(x.jsx)(N,{book:e})}))})]})}}]),a}(n.Component),L=a(104);function B(e){return Object(x.jsxs)(L.a,Object(s.a)(Object(s.a)({},e),{},{size:"lg","aria-labelledby":"contained-modal-title-vcenter",centered:!0,children:[Object(x.jsx)(L.a.Header,{closeButton:!0,children:Object(x.jsx)(L.a.Title,{id:"contained-modal-title-vcenter",children:Object(x.jsx)("h2",{children:"Welcome to Book Switch!"})})}),Object(x.jsxs)(L.a.Body,{className:"hor-ver-2",children:[Object(x.jsx)(C.a.Img,{style:{width:"270px"},src:"assets/welcomepage.jpg",alt:"Card image"}),Object(x.jsxs)("div",{children:[Object(x.jsx)("p",{children:"Thanks for joining Book Switch! You are now ready to switch books with other people in your community, creating a local book club in which instead of buying the same book many times, will allow a book to be read by many others. Start by editing your profile where you can add books to your library so other people can request a switch."}),Object(x.jsx)("p",{children:"You'll also be able to browse the books available in your city or search by title or author by using the search bar. We also added a cool feature: random book. You can try it!"})]})]}),Object(x.jsxs)(L.a.Footer,{children:[Object(x.jsx)(w.a,{onClick:e.handleFirstEdit,children:"Start by Editing your Profile"}),Object(x.jsx)(w.a,{onClick:e.onHide,children:"Close"})]})]}))}var F=function(e){var t=c.a.useState(!0),a=Object(g.a)(t,2),n=a[0],r=a[1];return Object(x.jsx)(x.Fragment,{children:Object(x.jsx)(B,{handleFirstEdit:e.handleFirstEdit,show:n,onHide:function(){return r(!1)}})})},_=a(102),U=a(103),M=a(64);var T=function(e){var t=Object(n.useState)(""),a=Object(g.a)(t,2),c=a[0],r=a[1],o=Object(n.useState)(e.book.title),i=Object(g.a)(o,2),l=i[0],d=i[1],j=Object(n.useState)(e.book.author),h=Object(g.a)(j,2),b=h[0],u=h[1],m=Object(n.useState)(e.book.description),O=Object(g.a)(m,2),p=O[0],f=O[1],k=Object(n.useState)(e.book.language),S=Object(g.a)(k,2),C=S[0],N=S[1],I=Object(n.useState)(e.book.category),E=Object(g.a)(I,2),B=E[0],F=E[1],_=Object(n.useState)(e.book.switchMode),U=Object(g.a)(_,2),M=U[0],T=U[1],D=Object(n.useState)([]),P=Object(g.a)(D,2),A=P[0],H=P[1];return Object(n.useEffect)((function(){if(l||b){var e=l?"/"+l:"";e=b?e+"/"+b:e,setTimeout((function(){v.a.get("/api/book/search".concat(e),{withCredentials:!0}).then((function(e){H(e.data)})).catch((function(){}))}),500)}}),[l,b]),Object(x.jsxs)(L.a,Object(s.a)(Object(s.a)({},e),{},{size:"lg","aria-labelledby":"contained-modal-title-vcenter",centered:!0,children:[Object(x.jsx)(L.a.Header,{closeButton:!0}),Object(x.jsx)("div",{className:"google-book-card",children:A&&A.filter((function(e,t){return t<3})).filter((function(e){return e.volumeInfo.imageLinks})).filter((function(e){return e.volumeInfo.authors})).map((function(e){var t=e.volumeInfo.title.length>15?e.volumeInfo.title.slice(0,15)+"...":e.volumeInfo.title;return Object(x.jsx)("a",{onClick:function(){d(e.volumeInfo.title),u(e.volumeInfo.authors[0]),f(e.volumeInfo.description.slice(0,400)),F(e.volumeInfo.categories[0]),r(e.volumeInfo.imageLinks.thumbnail)},children:Object(x.jsx)("div",{class:"col",children:Object(x.jsxs)("div",{class:"card",children:[Object(x.jsx)("img",{src:e.volumeInfo.imageLinks.smallThumbnail,alt:"book-cover"}),Object(x.jsxs)("div",{className:"card-body",children:[Object(x.jsx)("h5",{children:t}),Object(x.jsxs)("h5",{className:"text-muted",children:["by ",e.volumeInfo.authors[0]]})]})]})})})}))}),Object(x.jsx)(L.a.Body,{className:"hor-ver-2",children:Object(x.jsxs)(y.a,{onSubmit:function(t){e.onHide(),e.handleAddorEditBook(t)},children:[Object(x.jsxs)(y.a.Group,{children:[Object(x.jsx)(y.a.Label,{children:"Title"}),Object(x.jsx)(y.a.Control,{onChange:function(e){return d(e.target.value)},value:l,name:"title",required:!0,type:"text",placeholder:"Enter title"}),Object(x.jsx)(y.a.Control,{value:c,name:"photo",hidden:!0,type:"text",placeholder:"Enter title"})]}),Object(x.jsxs)(y.a.Group,{children:[Object(x.jsx)(y.a.Label,{children:"Author"}),Object(x.jsx)(y.a.Control,{onChange:function(e){return u(e.target.value)},value:b,name:"author",required:!0,type:"text",placeholder:"Enter author(s)"})]}),Object(x.jsxs)(y.a.Group,{children:[Object(x.jsx)(y.a.Label,{children:"Description"}),Object(x.jsx)(y.a.Control,{onChange:function(e){return f(e.target.value)},value:p,name:"description",type:"text",placeholder:"Enter description"})]}),Object(x.jsxs)(y.a.Group,{children:[Object(x.jsx)(y.a.Label,{children:"Language"}),Object(x.jsx)(y.a.Control,{onChange:function(e){return N(e.target.value)},value:C,name:"language",type:"text",placeholder:"Enter language"})]}),Object(x.jsxs)(y.a.Group,{children:[Object(x.jsx)(y.a.Label,{children:"Category"}),Object(x.jsx)(y.a.Control,{onChange:function(e){return F(e.target.value)},value:B,name:"category",required:!0,type:"text",placeholder:"Enter category"})]}),Object(x.jsxs)(y.a.Group,{children:[Object(x.jsx)(y.a.Label,{children:"Switch Mode"}),Object(x.jsx)(y.a.Control,{onChange:function(e){return T(e.target.value)},value:M,name:"switchMode",required:!0,type:"text",placeholder:"Enter Switch Mode"})]}),Object(x.jsx)(w.a,{variant:"primary",size:"lg",block:!0,type:"submit",children:"Save Book to Library"}),Object(x.jsx)(w.a,{onClick:e.onHide,children:"Close"})]})})]}))},D=function(e){Object(j.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,c=new Array(n),r=0;r<n;r++)c[r]=arguments[r];return(e=t.call.apply(t,[this].concat(c))).state={showTextArea:!1,showEditBookForm:!1},e.onHide=function(){e.setState({showEditBookForm:!1,showTextArea:!1})},e}return Object(d.a)(a,[{key:"render",value:function(){var e=this,t=this.state,a=t.showEditBookForm,n=t.showTextArea,c=this.props,r=c.book,o=c.user,s=c.handleDelete,i=c.handleEditBook,l=c.handleSendRequest;return Object(x.jsxs)(_.a,{children:[a&&Object(x.jsx)(T,{show:a,onHide:this.onHide,book:r,handleAddorEditBook:i}),Object(x.jsx)(C.a,{className:"text-center",children:Object(x.jsxs)(U.a,{className:"book-details",children:[Object(x.jsx)(M.a,{children:Object(x.jsx)(C.a.Img,{variant:"top",src:r.photo,alt:"book-cover"})}),Object(x.jsxs)(M.a,{children:[Object(x.jsxs)(C.a.Body,{children:[Object(x.jsx)(C.a.Title,{children:r.title}),Object(x.jsxs)(C.a.Title,{className:"text-muted",children:["by ",r.author]}),Object(x.jsx)(C.a.Text,{children:r.description}),Object(x.jsxs)(C.a.Text,{children:["Language: ",r.language]}),Object(x.jsxs)(C.a.Text,{children:["Category: ",r.category]})]}),Object(x.jsxs)(C.a.Footer,{children:[Object(x.jsx)("div",{children:Object(x.jsxs)("small",{className:"text-muted",children:["Switch Mode: ",r.switchMode]})}),Object(x.jsx)("div",{children:Object(x.jsxs)("small",{className:"text-muted",children:["City: ",r.owner.location.city]})})]}),n&&Object(x.jsxs)("form",{id:"userform",class:"center",onSubmit:function(t){e.onHide(),l(t)},children:[Object(x.jsx)("textarea",{name:"text",form:"userform",cols:"60",rows:"4",placeholder:"Enter your message here..."}),Object(x.jsx)("button",{type:"submit",class:"btn btn-primary btn-del",children:"Send"})]}),Object(x.jsxs)("div",{children:[o._id===r.owner._id&&Object(x.jsx)("img",{onClick:function(){return e.setState({showEditBookForm:!0})},style:{cursor:"pointer"},src:"/assets/008-edition.png",alt:"editbook-icon"}),o._id===r.owner._id&&Object(x.jsx)("img",{onClick:s,src:"/assets/032-delete-4.png",style:{cursor:"pointer"},alt:"deletebook-icon"}),o._id!==r.owner._id&&Object(x.jsx)(w.a,{onClick:function(){return e.setState({showTextArea:!0})},children:"Request Switch"})]})]})]})})]})}}]),a}(n.Component),P=function(e){Object(j.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,c=new Array(n),r=0;r<n;r++)c[r]=arguments[r];return(e=t.call.apply(t,[this].concat(c))).state={book:null},e.handleSendRequest=function(t){t.preventDefault();var a=t.target.text.value,n=e.state.book,c={text:a,bookRelated:n._id,between:[e.props.user._id,n.owner._id]};v.a.post("/api/message",c,{withCredentials:!0}).then((function(e){})).catch((function(e){console.log("Fetching failed")}))},e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params.bookId;v.a.get("/api/book/get/".concat(t)).then((function(t){e.setState({book:t.data})})).catch((function(e){console.log("Fetching failed")}))}},{key:"render",value:function(){var e=this.state,t=e.book,a=e.handleSendRequest,n=this.props,c=n.user,r=n.handleDelete,o=n.handleEditBook;if(!t||!c)return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(S.a,{animation:"border",variant:"primary"}),Object(x.jsx)(S.a,{animation:"border",variant:"secondary"}),Object(x.jsx)(S.a,{animation:"border",variant:"success"})]});t.owner._id;return Object(x.jsx)(D,{book:t,user:c,handleDelete:r,handleEditBook:o,handleSendRequest:a})}}]),a}(n.Component);var A=function(e){var t=Object(n.useState)([]),a=Object(g.a)(t,2),c=a[0],r=a[1],o=Object(n.useState)(e.user.name),i=Object(g.a)(o,2),l=i[0],d=i[1],j=Object(n.useState)(e.user.username),h=Object(g.a)(j,2),b=h[0],u=h[1],m=Object(n.useState)(e.user.lastName),O=Object(g.a)(m,2),p=O[0],f=O[1],k=Object(n.useState)(e.user.location),S=Object(g.a)(k,2),C=S[0],N=S[1];return Object(n.useEffect)((function(){var e=!0;return v.a.get("/api/location").then((function(t){e&&r(t.data)})).catch((function(e){console.log(e)})),function(){return e=!1}}),[]),Object(x.jsxs)(L.a,Object(s.a)(Object(s.a)({},e),{},{size:"lg","aria-labelledby":"contained-modal-title-vcenter",centered:!0,children:[Object(x.jsx)(L.a.Header,{closeButton:!0,children:Object(x.jsx)(L.a.Title,{id:"contained-modal-title-vcenter",children:"Edit your Profile"})}),Object(x.jsx)(L.a.Body,{children:Object(x.jsxs)(y.a,{onSubmit:function(t){e.onHide(),e.handleProfileChange(t)},children:[Object(x.jsxs)(y.a.Group,{children:[Object(x.jsx)(y.a.Label,{children:"Username"}),Object(x.jsx)(y.a.Control,{name:"username",required:!0,type:"text",placeholder:"Enter username",onChange:function(e){return u(e.target.value)},value:b})]}),Object(x.jsxs)(y.a.Group,{children:[Object(x.jsx)(y.a.Label,{children:"Name"}),Object(x.jsx)(y.a.Control,{name:"name",type:"text",placeholder:"Enter your name",onChange:function(e){return d(e.target.value)},value:l})]}),Object(x.jsxs)(y.a.Group,{children:[Object(x.jsx)(y.a.Label,{children:"Last Name"}),Object(x.jsx)(y.a.Control,{name:"lastName",type:"text",placeholder:"Enter your last name",onChange:function(e){return f(e.target.value)},value:p})]}),Object(x.jsxs)(y.a.Group,{children:[Object(x.jsx)(y.a.Label,{children:"City"}),Object(x.jsx)(y.a.Control,{as:"select",placeholder:"Select your city",name:"location",onChange:function(e){return N(e.target.value)},value:C,children:c.map((function(e,t){return Object(x.jsx)("option",{value:e._id,children:e.city},t)}))})]}),Object(x.jsx)(w.a,{variant:"primary",size:"lg",type:"submit",children:"Save Changes"}),Object(x.jsx)(w.a,{onClick:e.onHide,children:"Close"})]})}),Object(x.jsx)(L.a.Footer,{})]}))};function H(e){return Object(x.jsxs)(L.a,Object(s.a)(Object(s.a)({},e),{},{size:"sm","aria-labelledby":"contained-modal-title-vcenter",centered:!0,children:[Object(x.jsx)(L.a.Header,{closeButton:!0,children:Object(x.jsx)(L.a.Title,{children:"Choose a photo to upload"})}),Object(x.jsxs)(y.a,{onSubmit:function(t){e.onHide(),e.handlePhoto(t)},enctype:"multipart/form-data",children:[Object(x.jsx)("input",{type:"file",name:"photo",accept:"image/png, image/jpg"}),Object(x.jsx)(w.a,{type:"submit",children:"Upload Photo"})]})]}))}var G=function(e){Object(j.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,c=new Array(n),r=0;r<n;r++)c[r]=arguments[r];return(e=t.call.apply(t,[this].concat(c))).state={addFormShow:!1,profileFormShow:!1,showUploadPhotoForm:!1},e.onHide=function(){e.setState({addFormShow:!1})},e.handleProfileChange=function(t){t.preventDefault();var a={username:t.target.username.value,name:t.target.name.value,lastName:t.target.lastName.value,location:t.target.location.value,_id:e.props.user._id};v.a.post("/api/auth/user",a,{withCredentials:!0}).then((function(t){e.props.history.push("/profile")})).catch((function(e){console.log("Something went wrong",e)}))},e}return Object(d.a)(a,[{key:"render",value:function(){var e=this,t=this.state,a=t.addFormShow,n=t.profileFormShow,c=t.showUploadPhotoForm,r=this.props,o=r.userLibrary,s=r.user,i=r.handleDelete,l=r.handleEditBook,d=r.handleProfileChange,j=r.handleAddBook,h=r.handlePhoto;return s?Object(x.jsxs)("div",{className:"body-width",children:[a&&Object(x.jsx)(T,{show:a,onHide:this.onHide,book:{},handleAddorEditBook:j}),c&&Object(x.jsx)(H,{show:c,onHide:function(){return e.setState({showUploadPhotoForm:!1})},handlePhoto:h}),Object(x.jsxs)("h2",{children:["Hello ",s.name,"! ",Object(x.jsx)("br",{}),"Welcome to your profile"]}),Object(x.jsxs)(C.a,{className:"text-center",style:{width:"18rem",margin:"1em auto"},children:[Object(x.jsx)(C.a.Img,{variant:"top",src:s.photo,roundedCircle:!0}),Object(x.jsxs)("div",{children:[Object(x.jsx)("img",{src:"/assets/003-camera.png",style:{cursor:"pointer"},onClick:function(){return e.setState({showUploadPhotoForm:!0})},alt:"uploadphoto-icon"}),Object(x.jsx)("img",{style:{cursor:"pointer"},src:"/assets/008-edition.png",alt:"editprofile-icon",onClick:function(){return e.setState({profileFormShow:!0})}})]}),Object(x.jsxs)(C.a.Body,{children:[Object(x.jsx)(C.a.Title,{children:"Your details"}),Object(x.jsx)("table",{children:Object(x.jsxs)("tbody",{children:[Object(x.jsxs)("tr",{children:[Object(x.jsx)("th",{children:"Username:"}),Object(x.jsx)("td",{children:s.username})]}),Object(x.jsxs)("tr",{children:[Object(x.jsx)("th",{children:"Name:"}),Object(x.jsx)("td",{children:s.name})]}),Object(x.jsxs)("tr",{children:[Object(x.jsx)("th",{children:"Last name:"}),Object(x.jsx)("td",{children:s.lastName})]}),Object(x.jsxs)("tr",{children:[Object(x.jsx)("th",{children:"City:"}),Object(x.jsx)("td",{children:s.location.city})]}),Object(x.jsxs)("tr",{children:[Object(x.jsx)("th",{children:"Email:"}),Object(x.jsx)("td",{children:s.email})]})]})})]}),Object(x.jsx)(C.a.Footer,{}),n&&Object(x.jsx)(A,{show:n,user:s,handleProfileChange:d,onHide:function(){return e.setState({profileFormShow:!1})}})]}),Object(x.jsx)("div",{children:Object(x.jsx)("img",{src:"/assets/library.png",alt:"libraryicon"})}),!o.length&&Object(x.jsx)("h1",{children:"You have no books yet in your Library"}),Object(x.jsx)("img",{style:{cursor:"pointer"},src:"/assets/026-library-2.png",alt:"addbook-icon",onClick:function(){return e.setState({addFormShow:!0})}}),o.map((function(e){return Object(x.jsx)(D,{handleDelete:function(t){i(e._id,t)},handleEditBook:function(t){l(e._id,t)},user:s,book:e},e._id)}))]}):Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(S.a,{animation:"border",variant:"secondary"}),Object(x.jsx)(S.a,{animation:"border",variant:"light"}),Object(x.jsx)(S.a,{animation:"grow",variant:"primary"}),Object(x.jsx)(S.a,{animation:"grow",variant:"secondary"}),Object(x.jsx)(S.a,{animation:"grow",variant:"light"})]})}}]),a}(n.Component),R=function(e){Object(j.a)(a,e);var t=Object(h.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(d.a)(a,[{key:"render",value:function(){return Object(x.jsx)("div",{children:Object(x.jsx)("div",{className:"container-fluid pb-0 mb-0 justify-content-center",children:Object(x.jsxs)("footer",{children:[Object(x.jsx)("div",{className:"row justify-content-center py-5",children:Object(x.jsxs)("div",{className:"col-xl-8 col-sm-4 mb-2 my-auto mx-auto a",children:[Object(x.jsx)("h3",{className:"mb-md-0 mb-5 bold-text",children:"BookSwitch"}),Object(x.jsxs)("small",{className:"rights",children:[Object(x.jsx)("span",{children:"\xae"})," All Rights Reserved."]}),Object(x.jsx)("br",{}),Object(x.jsx)("h6",{className:"mb-2 bold-text py-2",children:Object(x.jsx)("b",{children:"Contact Us"})}),Object(x.jsx)("p",{className:"mb-1",children:"contact@bookswitch.com"})]})}),Object(x.jsxs)("div",{className:"row justify-content-center",children:[Object(x.jsxs)("p",{children:[Object(x.jsx)("img",{className:"my-3 ",width:"90px",src:"/assets/800px-MERN-logo.png",alt:"mernlogo"}),Object(x.jsx)("span",{className:"bold-text py-1",children:"IRONHACKERS"})]}),Object(x.jsxs)("div",{className:"col-md-4 py-1 ",children:[Object(x.jsx)("h6",{className:"mb-2 bold-text",children:Object(x.jsx)("b",{children:"Georgina Morales"})}),Object(x.jsx)("small",{children:" georgina@bookswitch.com"})]}),Object(x.jsxs)("div",{className:"col-md-4 py-1 ",children:[Object(x.jsx)("h6",{className:"mb-2 bold-text",children:Object(x.jsx)("b",{children:"Erdem Taskin"})}),Object(x.jsx)("small",{children:"erdem@bookswitch.com"})]})]})]})})})}}]),a}(n.Component);var q=function(e){var t=Object(n.useState)(""),a=Object(g.a)(t,2),c=a[0],r=a[1],o=Object(n.useState)(""),s=Object(g.a)(o,2),i=s[0],l=s[1];return Object(x.jsx)("div",{children:Object(x.jsxs)(y.a,{className:"body-width",onSubmit:e.handleSubmit,children:[Object(x.jsxs)(y.a.Group,{controlId:"formBasicEmail",children:[Object(x.jsx)(y.a.Label,{children:"Email address"}),Object(x.jsx)(y.a.Control,{required:!0,name:"email",type:"email",placeholder:"Enter email",onChange:function(e){return r(e.target.value)},value:c})]}),Object(x.jsxs)(y.a.Group,{controlId:"formBasicPassword",children:[Object(x.jsx)(y.a.Label,{children:"Password"}),Object(x.jsx)(y.a.Control,{required:!0,name:"password",type:"password",placeholder:"Password",onChange:function(e){return l(e.target.value)},value:i})]}),Object(x.jsx)(w.a,{variant:"primary",size:"lg",block:!0,type:"submit",children:"Submit"})]})})},z=function(e){Object(j.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,c=new Array(n),r=0;r<n;r++)c[r]=arguments[r];return(e=t.call.apply(t,[this].concat(c))).state={messages:null,loggedInUser:null},e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.state.loggedInUser||v.a.get("/api/auth/user",{withCredentials:!0}).then((function(t){e.setState({loggedInUser:t.data})})).catch((function(){})),v.a.get("/api/message",{withCredentials:!0}).then((function(t){e.setState({messages:t.data})})).catch((function(){console.log("Fetching failed")}))}},{key:"render",value:function(){var e=this.state,t=e.messages,a=e.loggedInUser;if(!t||!a)return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(S.a,{animation:"border",variant:"primary"}),Object(x.jsx)(S.a,{animation:"border",variant:"secondary"}),Object(x.jsx)(S.a,{animation:"border",variant:"success"}),Object(x.jsx)(S.a,{animation:"grow",variant:"primary"}),Object(x.jsx)(S.a,{animation:"grow",variant:"secondary"}),Object(x.jsx)(S.a,{animation:"grow",variant:"success"})]});var n=[],c=[];return t.filter((function(e){return e.bookRelated})).forEach((function(e){var t=e.between[0]._id===a._id?e.between[1]:e.between[0];if(!n.includes(t._id)){var r={contact:t,bookRelated:e.bookRelated,date:e.date.toString().substring(4,9)+e.date.toString().substring(14,21),text:e.text};n.push(t._id),c.push(r)}})),Object(x.jsxs)("div",{children:[c.length?Object(x.jsx)("h1",{children:"Your Messages"}):Object(x.jsx)("h1",{children:"You have no Messages yet"}),Object(x.jsx)("div",{className:"list-group",children:c.map((function(e){var t="/messages/"+e.contact._id;return Object(x.jsx)(u.b,{to:t,class:"list-group-item-action",children:Object(x.jsx)("div",{className:"card mb-3 body-width",children:Object(x.jsxs)("div",{className:"row g-0 hor-ver-2",children:[Object(x.jsx)("div",{className:"col-md-4",children:Object(x.jsx)("img",{className:"small-image",src:e.bookRelated.photo,alt:"bookImage"})}),Object(x.jsx)("div",{className:"col-md-8",children:Object(x.jsxs)("div",{className:"card-body",children:[Object(x.jsxs)("h5",{className:"card-title",children:["Messages with ",Object(x.jsx)("span",{children:e.contact.username})]}),Object(x.jsxs)("h5",{className:"card-title",children:["Book to Switch ",Object(x.jsx)("span",{children:e.bookRelated.title})]}),Object(x.jsxs)("h5",{className:"card-title",children:["Book to Switch ",Object(x.jsx)("span",{children:e.bookRelated.author})]}),Object(x.jsx)("p",{className:"card-text",children:e.text}),Object(x.jsx)("p",{className:"text-muted",children:e.date})]})})]})})},e.contact._id)}))})]})}}]),a}(n.Component),Y=function(e){Object(j.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,c=new Array(n),r=0;r<n;r++)c[r]=arguments[r];return(e=t.call.apply(t,[this].concat(c))).state={messages:[],book:"",contact:"",loggedInUser:"",input:""},e.handleSubmit=function(t){t.preventDefault();var a=t.target.text.value;t.target.reset();var n={text:a,between:[e.state.loggedInUser._id,e.state.contact._id],bookRelated:e.state.book};v.a.post("/api/message",n,{withCredentials:!0}).then((function(t){e.setState({messages:[].concat(Object(i.a)(e.state.messages),[t.data])},(function(){e.props.history.push("/messages/".concat(e.state.contact._id))}))})).catch((function(e){console.log(e)}))},e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.state.loggedInUser||v.a.get("/api/auth/user",{withCredentials:!0}).then((function(t){e.setState({loggedInUser:t.data})})).catch((function(){}));var t=this.props.match.params.contactId;v.a.get("/api/message/".concat(t),{withCredentials:!0}).then((function(a){var n=a.data[0].between[0]._id===t?a.data[0].between[0]:a.data[0].between[1];e.setState({messages:a.data,book:a.data[0].bookRelated,contact:n},(function(){return console.log(e.state.book,e.state.contact)}))})).catch((function(){console.log("Fetching failed")}))}},{key:"render",value:function(){var e=this.state,t=e.messages,a=e.book,n=e.contact,c=(e.input,"/book/"+a._id);return Object(x.jsxs)("div",{className:"div-message",children:[Object(x.jsx)(u.b,{className:"book-link",to:c,children:Object(x.jsx)("div",{className:"messages-div list-group",children:Object(x.jsx)("div",{className:"card mb-3",style:{maxWidth:"800px"},children:Object(x.jsxs)("div",{className:"row g-0",children:[Object(x.jsx)("div",{className:"col-md-4",children:Object(x.jsx)("img",{className:"small-image",src:this.state.book.photo,alt:"book-cover"})}),Object(x.jsx)("div",{className:"col-md-8",children:Object(x.jsxs)("div",{className:"card-body",children:[Object(x.jsx)("h4",{className:"card-title",children:this.state.book.title}),Object(x.jsxs)("h5",{className:"card-title",children:["by ",this.state.book.author," "]}),Object(x.jsxs)("h5",{className:"card-title",children:["to ",this.state.book.switchMode]}),Object(x.jsx)("p",{className:"card-text",children:this.state.book.description})]})})]})})})}),Object(x.jsxs)("h2",{children:["Messages with ",n.username]}),t.map((function(e){var t=e.date,a=e.between[1]._id===n._id?"div-right":"div-left";return Object(x.jsxs)("div",{className:a,children:[e.text,Object(x.jsx)("br",{}),Object(x.jsx)("span",{className:"small text-muted",children:t})]})})),Object(x.jsxs)("form",{className:"message-form",onSubmit:this.handleSubmit,children:[Object(x.jsx)("input",{name:"text",required:"true",type:"text",className:"form-control"}),Object(x.jsx)("button",{type:"submit",className:"btn btn-primary btn-del",children:"Send"})]})]})}}]),a}(n.Component),W=function(e){Object(j.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,c=new Array(n),r=0;r<n;r++)c[r]=arguments[r];return(e=t.call.apply(t,[this].concat(c))).state={loggedInUser:"",isNewUser:!0,userLibrary:[]},e.handlePhoto=function(e){e.preventDefault();var t=e.target.photo.files[0],a=new FormData;a.append("imageUrl",t),v.a.post("/api/cloudinary/upload",a).then((function(e){console.log(e.data)})).catch((function(){}))},e.handleSignUp=function(t){t.preventDefault();var a={username:t.target.username.value,name:t.target.name.value,lastName:t.target.lastName.value,email:t.target.email.value,password:t.target.password.value,location:t.target.location.value};v.a.post("/api/auth/signup",a,{withCredentials:!0}).then((function(t){e.setState({loggedInUser:t.data,isNewUser:!0},(function(){e.props.history.push("/")}))})).catch((function(e){console.log(e)}))},e.handleLogIn=function(t){t.preventDefault();var a={email:t.target.email.value,password:t.target.password.value};v.a.post("/api/auth/login",a,{withCredentials:!0}).then((function(t){e.setState({loggedInUser:t.data},(function(){e.props.history.push("/")}))})).catch((function(e){console.log("Something went wrong",e)}))},e.handleLogout=function(){v.a.post("/api/auth/logout",{},{withCredentials:!0}).then((function(){e.setState({loggedInUser:null},(function(){e.props.history.push("/")}))}))},e.handleFirstEdit=function(e){},e.handleEditBook=function(t,a){a.preventDefault();var n=a.target.title.value,c=a.target.author.value,r=a.target.description.value,o=(a.target.photo.value,{title:n,author:c,description:r,language:a.target.language.value,category:a.target.category.value,switchMode:a.target.switchMode.value});v.a.post("/api/book/edit/".concat(t),o,{withCredentials:!0}).then((function(a){var n=a.data,c=e.state.userLibrary.map((function(e){return e._id===n._id?(n.owner=e.owner,n):e}));e.setState({userLibrary:c},(function(){e.props.history.push("/book/".concat(t))}))})).catch((function(e){console.log("Something went wrong",e)}))},e.handleAddBook=function(t){t.preventDefault();var a=t.target.photo.value,n={title:t.target.title.value,author:t.target.author.value,description:t.target.description.value,language:t.target.language.value,category:t.target.category.value,photo:a,switchMode:t.target.switchMode.value};v.a.post("/api/book/add",n,{withCredentials:!0}).then((function(t){var a=t.data;e.setState({userLibrary:[a].concat(Object(i.a)(e.state.userLibrary))})})).catch((function(e){console.log("Something went wrong",e)}))},e.handleDelete=function(t){v.a.delete("/api/book/delete/".concat(t),{withCredentials:!0}).then((function(){var a=e.state.userLibrary.filter((function(e){return e._id!==t}));e.setState({userLibrary:a},(function(){e.props.history.push("/profile")}))})).catch((function(e){console.log("Delete failed",e)}))},e.handleProfileChange=function(t){t.preventDefault();var a={username:t.target.username.value,name:t.target.name.value,lastName:t.target.lastName.value,location:t.target.location.value,_id:e.state.loggedInUser._id};v.a.post("/api/auth/user",a,{withCredentials:!0}).then((function(t){e.setState({loggedInUser:t.data},(function(){e.props.history.push("/profile")}))})).catch((function(e){console.log("Something went wrong",e)}))},e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){var e=this;v.a.get("/api/auth/user",{withCredentials:!0}).then((function(t){e.setState({loggedInUser:t.data},(function(){v.a.get("/api/book/user/".concat(e.state.loggedInUser._id)).then((function(t){e.setState({userLibrary:t.data})}))}))})).catch((function(){}))}},{key:"render",value:function(){var e=this;return Object(x.jsxs)("div",{className:"App",children:[Object(x.jsx)(p,{handleLogout:this.handleLogout,handleLogIn:this.handleLogIn,handleSignUp:this.handleSignUp,user:this.state.loggedInUser}),this.state.isNewUser&&Object(x.jsx)(F,{handleFirstEdit:this.handleFirstEdit}),Object(x.jsxs)(b.c,{children:[Object(x.jsx)(b.a,{exact:!0,path:"/",render:function(e){return Object(x.jsx)(E,Object(s.a)({},e))}}),Object(x.jsx)(b.a,{exact:!0,path:"/messages",render:function(e){return Object(x.jsx)(z,Object(s.a)({},e))}}),Object(x.jsx)(b.a,{path:"/signup",render:function(t){return Object(x.jsx)(k,Object(s.a)({handleSubmit:e.handleSignUp},t))}}),Object(x.jsx)(b.a,{path:"/login",render:function(t){return Object(x.jsx)(q,Object(s.a)({handleSubmit:e.handleLogIn},t))}}),Object(x.jsx)(b.a,{path:"/book/:bookId",render:function(t){return Object(x.jsx)(P,Object(s.a)({user:e.state.loggedInUser,handleAddBook:e.handleAddBook,handleDelete:e.handleDelete,handleEditBook:e.handleEditBook},t))}}),Object(x.jsx)(b.a,{path:"/messages/:contactId",render:function(e){return Object(x.jsx)(Y,Object(s.a)({},e))}}),Object(x.jsx)(b.a,{path:"/profile",render:function(t){return Object(x.jsx)(G,Object(s.a)({userLibrary:e.state.userLibrary,user:e.state.loggedInUser,handleAddBook:e.handleAddBook,handleDelete:e.handleDelete,handleEditBook:e.handleEditBook,handleProfileChange:e.handleProfileChange,handlePhoto:e.handlePhoto},t))}})]}),Object(x.jsx)(R,{})]})}}]),a}(n.Component),J=Object(b.f)(W);o.a.render(Object(x.jsx)(c.a.StrictMode,{children:Object(x.jsx)(u.a,{children:Object(x.jsx)(J,{})})}),document.getElementById("root"))}},[[99,1,2]]]);
//# sourceMappingURL=main.4d4cc366.chunk.js.map